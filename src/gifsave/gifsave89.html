<!--
 ****************************************************************************
 * Copyright(c) 2012-2012, John Forkosh Associates, Inc. All rights reserved.
 *   http://www.forkosh.com  mailto: john@forkosh.com  revised: 29-Sep-2012
 * ==========================================================================
 * This file is part of gifsave89, which is free software.
 * You may redistribute and/or modify it under the terms of the
 * GNU General Public License, version 3 or later, as published
 * by the Free Software Foundation.
 *      gifsave89 is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY, not even the implied warranty of MERCHANTABILITY.
 * See the GNU General Public License for specific details.
 *      By using gifsave89, you warrant that you have read, understood and
 * agreed to these terms and conditions, and that you possess the legal
 * right and ability to enter into this agreement and to use gifsave89
 * in accordance with it.
 *      Your gifsave89.zip distribution should contain the file COPYING,
 * an ascii text copy of the GNU General Public License, version 3.
 * If not, point your browser to  http://www.gnu.org/licenses/
 * or write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330,  Boston, MA 02111-1307 USA.
 ****************************************************************************
 -->

<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Preamble
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<html>
  <head>
    <title> gifsave89 </title>
    <meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
    <style type="text/css">
      body      { background-image:  none;
                  background-color:  #ffffff;   color: #000000;
                  margin-left: 0.5em;  margin-right: 0.1em;
                  font-size: large;
                  clear: both }
      A:active  { color: blue; text-decoration: none }
      A:link    { color: blue; text-decoration: none }
      A:visited { color: blue; text-decoration: none }
      A:hover   { color: red;  text-decoration: underline }
      h2        { color: maroon;  text-decoration: underline;
                  font-style: normal;
                  padding-top: 2.0em;
                  letter-spacing: 0.25em }
      h3        { color: maroon;
                  font-style: normal;  font-size: x-large;
                  margin-left: 1em;
                  padding-top: 0.5em;
                  letter-spacing: 0.15em }
      h4        { color: maroon;
                  font-style: normal;  font-size: large;
                  margin-left: 1.5em; margin-bottom: 0.0em;
                  padding-top: 0.5em; padding-bottom: 0.0em;
                  letter-spacing: 0.125em }
      table     { font-size: large }
      ul        { margin-left: 1.0em;   margin-right: 2.5em;
                  list-style-type: square }
      ul ul     { margin-left: -0.5em;  margin-right: 3.5em;
                  list-style-type: disc }
      p         { margin-left: 1.5em;   margin-right: 1.5em }
      pre       { margin-left: 1.5em }
      pre.medium { margin-left: 1.5em; font-size:medium }
      p:first-letter
                { font-size: x-large;   font-weight: bold;
                  color: maroon }
      p.continue { margin-left: 1.5em;   margin-right: 1.5em;
                   padding-top: -0.1em }
      p.continue:first-letter
                { font-size: large;   font-weight: normal;
                  color: black }
      p.pre     { margin-left: 1.5em;   margin-right: 1.5em;
                  margin-bottom: 0.0em; margin-top: 0.0em; }
    </style>
  </head>
<body>

<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Banner across top of page containing title and two example gifsave89 images
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<br>
<hr size=4>
<center>
 <table cellspacing=10>
  <tr>
   <td align="center">
      <img src="http://www.forkosh.com/images/gifsave89/example1.gif"
       width=150 height=125> </td>
   <td align="center" valign="middle">
      <center><font color="maroon" size=4><b>
      <nobr>g i f s a v e 8 9 &nbsp; </nobr></b> <br>
      <font size=3>( for gifsave89 version 1.00 )</font> <br>
      <font size=3> <b>Click for:</b> &nbsp;
        <a href="http://www.forkosh.com/gifsave89.zip">
        <font size=4>download&nbsp;gifsave89</font></a> </font>
      </font></center> </td>
   <td align="center">
      <img src="http://www.forkosh.com/images/gifsave89/example2.gif"
       width=150 height=125>
      <!-- br> <a href="#examples">more_examples...</a --> </td>
  </tr>
  <tr> <td align="center" colspan="3"> <font size="3">
   This page discusses gifsave89, a small C library that renders
   gif images and animations. </font> </td> </tr>
 </table>
</center>
<hr size=4>
<center><b><font color="maroon" size=3>
Copyright <font size=5>&copy;</font> 2012-2012,
<a href="http://www.forkosh.com">John Forkosh Associates, Inc.</a> <br>
email: <a href="mailto:john&#64;forkosh&#46;com">john&#64;forkosh&#46;com</a>
</font></b> <br><br>
<img  src="http://www.forkosh.com/mathtex.cgi?\parstyle\usepackage{color}
\large\color{blue}\begin{center}\today,\;\;\time\end{center}"
alt="" border=0 align=middle><br>
<font color="maroon" size=4> (Last revised: September 29, 2012) </font>
</center>

<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Table of Contents and QuickStart Summary
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<br>
<p> <font color="blue"> This page contains more information
than you'll probably need to read.  If you follow the
QuickStart instructions below, try using gifsave89 immediately.
If you need more information,
continue reading until you feel comfortable trying to use gifsave89.
Return to this page as needed.
Prerequisites are: some knowledge of&nbsp;C, and of&nbsp;gif images. </font>
<font color="maroon"> <br>
&nbsp; &nbsp; &nbsp; &nbsp;
     <b>&quot</b><i>Computers are like Old Testament gods<b>:</b>
     lots of rules and no mercy.</i><b>&quot</b><br>
&nbsp; &nbsp; &nbsp; &nbsp;
     Joseph Campbell, The Power of Myth &nbsp;
     (Doubleday 1988, page 18) </font> </p>

<br> <center>
<table id="quickstart" border="0">
<tr> <!-- banner -->
 <td align="center">
   <b><font color="maroon" size=4>
   <u> &nbsp; &nbsp; C o n t e n t s &nbsp; &nbsp; </u></font></b></td>
 <td> &nbsp; </td>
 <td align="center"><b><font color="maroon" size=4>
   <u> &nbsp; &nbsp; Q u i c k S t a r t &nbsp; &nbsp;
   </u></font></b></td>
</tr>
<tr>
 <td valign="top"> <!-- table of contents -->
  <table cellspacing=0>
   <tr>
    <td valign="top" align="left">
     <font size=4>
      <a href="#prototypes">    Function&nbsp;Prototypes </a><br>
      <a href="#introduction">  (1) Introduction&Usage </a><br>
   <!-- &nbsp; &nbsp; &nbsp; <a href="#subsection">  subsection </a><br> -->
      <a href="#extensions">    (2) Extensions </a><br>
        &nbsp; &nbsp; &nbsp; <a href="#animations"> application </a><br>
        &nbsp; &nbsp; &nbsp; <a href="#graphiccontrol"> control </a><br>
        &nbsp; &nbsp; &nbsp; <a href="#plaintext">    plaintext </a><br>
   <!-- &nbsp; &nbsp; &nbsp; <a href="#subsection">  subsection </a><br> -->
      <a href="#compiling">     (3) Compiling&Testing </a><br>
   <!-- &nbsp; &nbsp; &nbsp; <a href="#subsection">  subsection </a><br> -->
      <a href="#gifgraph">      (4) gifgraph </a><br>
   <!-- &nbsp; &nbsp; &nbsp; <a href="#subsection">  subsection </a><br> -->
      <a href="#gpl">           (5) GPL License </a><br>
      <font color="maroon" size=4> <br> <b><u> &nbsp;
      Related &nbsp; Pages &nbsp; </u></b></font> <br>
      <a href="http://www.forkosh.com/gifsave89changelog.html" target="_top">
         <font size=4>gifsave89 changeLog</font></a> <br>
      <a href="http://www.forkosh.com/cgi-bin/weblist.cgi?-t=weblist
     &-f=sources/weblistemplate.html
     &files=@sources/sourcecode/gifsave89.lis&copyright=2012-2011
     &counter=gifsave89&title=gifsave89
     &description=g i f s a v e 8 9  S o u r c e   L i s t i n g"
       target="_top"><font size=4>gifsave89 Listing</font></a> <br>
     </font>
    </td>
   </tr>
  </table>
 </td>
 <td> &nbsp; &nbsp; </td>
 <td valign="top"> <!-- summary -->
  <table border="0" cellpadding="0" cellspacing="0" hspace="0" vspace="0">
    <tr><td align="right" valign="top">
      <a href="#compiling">Compiling</a>: &nbsp; </td>
      <td> Download <a href="http://www.forkosh.com/gifsave89.zip">
       gifsave89.zip</a> and type <br>
       <b> &nbsp; &nbsp; unzip gifsave89.zip</b> <br>
       <b> &nbsp; &nbsp; cc &nbsp; yourprogram.c &nbsp; gifsave89.c \ <br>
       &nbsp; &nbsp; &nbsp; &#150;o yourprogram</b> <br>
       <nobr> &nbsp; &nbsp; (see <a href="#compiling">Compiling</a>
       for more information) </nobr> <br>
       </td></tr>
    <tr><td colspan="2"> &nbsp; </td></tr>
    <tr><td align="right" valign="top">
      <a href="#introduction">Usage</a>: &nbsp; </td>
      <td>Your program should contain something like,<br>
    <pre class="medium" style="margin-top:0;margin-bottom:0;">
 void *gsdata=NULL, *newgif();
 int  nbytes=0, putgif(), endgif();
 int  ncols=255, nrows=255,
      *colortable = {255,255,255, 0,0,0, -1}, bgindex=0;
 unsigned char pixels[99999] = {0,1,0,1/*,...,ncols*nrows*/};
 unsigned char *gifimage = NULL;
 generate_your_own(pixels,ncols,nrows);
 gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
 if ( gsdata != NULL ) {
   putgif(gsdata,pixels);
   nbytes = endgif(gsdata); }
 if ( nbytes &gt; 0 ) {
   do_what_you_want_with(gifimage,nbytes);
   free(gifimage); }</pre>
       <nobr> &nbsp; &nbsp; (see <a href="#prototypes">Prototypes</a>
       and <a href="#introduction">Usage</a> for more information) </nobr>
   </td></tr>
  </table>
 </td>
</tr>
</table>
</center>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ SYNOPSIS OF PROTOTYPES
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="prototypes"> Synopsis of gifsave89
Function Prototypes &nbsp; </h2>

<p> A complete, ready to compile and run,
    <a href="#sampleprogram">Sample&nbsp;Program</a>
    is illustrated in the <a href="#introduction">Introduction</a>,
    and "coding&nbsp;templates" for
    <a href="#sampleremarks">single&nbsp;gif's</a>
    and <a href="#animationtemplate">gif&nbsp;animations</a>
    are illustrated in the subsequent discussion.
    After you've read that, the function prototypes
    immediately below are for quick reference... </p>

<center>
  <table border="0" cellpadding="0" cellspacing="0" hspace="0" vspace="0">
    <tr> <td colspan=3 align="center">
         <nobr>/* -------
         call newgif() once,
         then putgif() one or more times, finally endgif() once
         ------- */</nobr>
    <tr>
      <td align="right" valign="top"> void &nbsp; </td>
      <td align="left" valign="top">
          // <a href="#newgifprototype">*gsdata</a> = &nbsp; </td>
      <td align="left" valign="top"> &nbsp;
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#newgifprototype">*newgif</a> &nbsp; </td>
      <td align="left" valign="bottom"> <nobr>
       ( void <a href="#endgifprototype">**gifimage</a>,
          int <a href="#ncolsnrows">width</a>,
          int <a href="#ncolsnrows">height</a>,
          int <a href="#colortable">colortable[]</a>,
          int <a href="#colortable">bgindex</a> ); </nobr>
    </td></tr>
    <tr>
      <td align="right" valign="top"> int &nbsp; </td>
      <td align="left" valign="top">
          // <a href="#endgifprototype">nbytes</a> = &nbsp; </td>
      <td align="left" valign="top"> &nbsp;
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#sampleremarks">putgif</a> &nbsp; </td>
      <td align="left" valign="top"> <nobr>
        ( void <a href="#newgifprototype">*gsdata</a>,
          unsigned char <a href="#pixels">pixels[]</a> ), </nobr>
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#endgifprototype">endgif</a> &nbsp; </td>
      <td align="left" valign="top">
          <nobr> ( void *gsdata ), </nobr>
    </td></tr>
    <tr> <td colspan=3 align="center">
         <nobr>/* ---------------
         optional gif extension functions
         --------------- */</nobr>
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#animateprototype">animategif</a> &nbsp; </td>
      <td align="left" valign="top">
          <nobr> ( void *gsdata, int nrepetitions, int delay,
          int tcolor, int disposal ), </nobr>
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#controlprototype">controlgif</a> &nbsp; </td>
      <td align="left" valign="top">
          <nobr> ( void *gsdata, int tcolor, int delay,
          int userinput, int disposal ), </nobr>
    </td></tr>
    <tr>
      <td align="right" valign="top"> &nbsp; </td>
      <td align="right" valign="top">
          <a href="#plaintextprototype">plaintxtgif</a> &nbsp; </td>
      <td align="left" valign="top">
          <nobr> ( void *gsdata, int left, int top, int width, int height,
          int fg, int bg, char *text ); </nobr>
    </td></tr>
  </table>
</center>

<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ INTRODUCTION AND USAGE
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="introduction"> (1) Introduction and Usage &nbsp; </h2>

<p class="continue">
    &nbsp;<font color="maroon">gifsave89</font>, licensed under the
    <a href="http://www.gnu.org/licenses/gpl.html" target="_top">gpl</a>,
    is a small&nbsp;C&nbsp;library that renders an
    in&#150;memory&nbsp;gif from a sequence of bytes representing the
    pixels comprising your image. </p>

<h3 id="sampleprogram"> Sample program </h3>
<p style="margin-bottom:0">
  A small sample program using gifsave89 is illustrated immediately below,
  and then further discussed below that. A more comprehensive
  sample program is gifsave.c's&nbsp;main() test&nbsp;driver in your
  <a href="http://www.forkosh.com/gifsave89.zip">gifsave89.zip</a>
  distribution&nbsp;file, which also contains a complete and useful
  application, <a href="#gifgraph">gifgraph.c</a>, discussed later. </p>
  <pre class="medium" style="margin-top:0;margin-bottom:0;">

  #include &lt;stdio.h&gt;
  int main ( int argc, char *argv[] ) {
   /* --- gifsave89's three functions: newgif(),putgif(),endgif() --- */
   void *gsdata=NULL, *newgif();
   int  nbytes=0, putgif(), endgif();
   /* --- your two funcs: generate pixels, do something with gif  --- */
   int  generate_your_own(), do_what_you_want_with();
   /* --- additional variables --- */
   int  colortable[]={255,255,255, 0,0,255, -1}, bgindex=0;
   int  ncols=255, nrows=255;
   unsigned char pixels[99999] = {0,1,0,1/*,...,ncols*nrows*/};
   unsigned char *gifimage = NULL;
   /* --- easter egg ( to be explained later :) --- */
   char *text = "\\LARGE{\\frac1{sqrt{a^2+b^2}}\\atop\\rm hello, world}";
   int  left=40, top=100, fg=0, bg=1;
   /* --- generate your own pixels --- */
   generate_your_own(pixels,ncols,nrows);
   /* --- render gif from them --- */
   gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
   if ( gsdata != NULL ) {
     plaintxtgif(gsdata,left,top, 0,0, fg,bg, text); /*easter egg in action*/
     putgif(gsdata,pixels);
     nbytes = endgif(gsdata); }
   /* --- do what you want with the gif (e.g., write to a file) --- */
   if ( nbytes &gt; 0 ) {
     do_what_you_want_with(gifimage,nbytes);
     free(gifimage); }
   return ( 0 );
   } /* --- end-of-function main() --- */

  /* --- example: draw a triangle --- */
  int generate_your_own ( unsigned char *pixels, int ncols, int nrows ) {
   int  icol=0, irow=0, npixels=0;
   for ( irow=0; irow&lt;nrows; irow++ ) {
     int locol=(ncols-irow)/2, hicol=(ncols+irow)/2;
     for ( icol=0; icol&lt;ncols; icol++ ) {
       int icolor = (icol&gt;=locol&&icol&lt;=hicol?1:0);
       pixels[npixels++] = ((unsigned char)icolor); } }
   return ( npixels );
   } /* --- end-of-function generate_your_own() --- */

  /* --- example: just write gifimage to a file --- */
  int do_what_you_want_with ( unsigned char *gifimage, int nbytes ) {
   FILE *fileptr = fopen("gifsave89test.gif","wb");
   int  nwritten = 0;
   if ( fileptr != NULL ) {
     nwritten = fwrite(gifimage,sizeof(unsigned char),nbytes,fileptr);
     fclose(fileptr); }
   return ( nwritten );
   } /* --- end-of-function do_what_you_want_with() --- */</pre>

<p> Cut-and-paste the above program into file gifsave89test.c,
    download and unzip <a href="http://www.forkosh.com/gifsave89.zip">
    gifsave89.zip</a>,<br>
    and then type <br>
    <nobr> &nbsp; &nbsp; &nbsp;
      <b>cc gifsave89test.c gifsave89.c &#150;o gifsave89test</b></nobr><br>
    <nobr> &nbsp; &nbsp; &nbsp;
      <b>./gifsave89test</b></nobr></p>

<p> Now display or point your browser to the program's output file,
    gifsave89test.gif,<br>
    and you should see, <br>
    <nobr> &nbsp; &nbsp; &nbsp;
      <img src="http://www.forkosh.com/images/gifsave89/example3.gif"
      width=255 height=255></nobr><br> </p>

<p> Okay, there's a little extra&nbsp;"easter&nbsp;egg" in there,
    illustrating <a href="#plaintext">gifsave89's&nbsp;implementation</a>
    of the intended but deprecated
  <a href="http://www.libpng.org/pub/png/book/chapter11.html#png.ch11.div.14">
    gIFt&nbsp;PLAINTEXT</a>&nbsp;extension. <br>
        &nbsp; &nbsp; &nbsp; If your computer has
    <a href="http://www.gnu.org/software/wget">wget</a> installed,
    and on your default path, then the above program should
    reproduce the triangle-plus-text as shown,
    and you can change the&nbsp;<b>char&nbsp;*text</b>&nbsp;string
    above to most valid
    <a href="http://www.forkosh.com/mathtextutorial.html">
    LaTeX&nbsp;math</a>&nbsp;expressions,
    adjust <b>left</b>&nbsp;and&nbsp;<b>top</b> accordingly,
    and watch what happens.
    Otherwise, just comment out the <b>plaintxtgif(&nbsp;)</b>&nbsp;call,
    and you should see the triangle&nbsp;without&nbsp;text. </p>

<p> Meanwhile, "easter egg" aside, examine the above program to see
    how you might use gifsave89 in your own programs for your own purposes.
    Not illustrated above are gif&nbsp;animations
    and graphic&nbsp;controls, which are separately
    discussed under <a href="#extensions">Extensions</a>.
    Immediately below are discussed some details about the
    above code that might remain murky even after studying it<b>...</b></p>

<h3 id="samplefuncsandargs"> gifsave89 functions and arguments
used by sample program </h3>
<h4 id="newgifprototype">void *gsdata, *newgif();</h4>
<br><p class="pre">
    Initialize the gifsave89 library by a call to newgif() of the form</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     void *gsdata=NULL, *newgif();
     ...
     gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);</pre>
<p class="pre">
    &nbsp;gsdata is returned by newgif() and then always passed as the
    first argument to every other gifsave89 function.
    It holds all local&nbsp;variables used by gifsave89,
    and is free()'ed for you by endgif().
    Its internal structure is user-irrelevant, but may be
    examined in gifsave89.c if curious.<br>
    The other arguments to newgif() (and to putgif() and endgif())
    are discussed below...</p>

<h4 id="endgifprototype">unsigned char *gifimage; &nbsp; int nbytes;</h4>
<p> &nbsp;gifimage is a pointer to the buffer that will
    contain nbytes=endgif(gsdata) bytes comprising your gif&nbsp;image
    after gifsave89 finishes rendering it. </p>

<p> Note that you <b>don't</b>&nbsp;malloc()&nbsp;(or&nbsp;declare)
    any bytes for gifimage; just the pointer whose <b>address</b>
    you pass as the first argument to
    newgif(<b>&amp;</b>gifimage,...)<b>.</b> &nbsp;
    newgif() receives this argument as
    unsigned&nbsp;char&nbsp;**gifimage, and then
    *gifimage=malloc()&nbsp;(and&nbsp;realloc())
    as necessary. So that's all done for you by gifsave89,
    but you should free(gifimage) after you've finished using it.</p>

<h4 id="ncolsnrows">int ncols, nrows;</h4>
<p> As you already surmised: ncols is the width of your image,
    and nrows its height, both in #pixels. </p>

<h4 id="colortable">int colortable[], bgindex;</h4>
<br><p class="pre"> The array </p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     int colortable[] = { r0,g0,b0, r1,g1,b1, r2,g2,b2, ..., -1 };</pre>
<p class="pre">&nbsp;is a sequence of ints, each one 0 to 255,
    interpreted as&nbsp;r,g,b-values, 0="black", 255="white".
    Terminate the sequence with any negative number.
    The first three colortable[] numbers are the&nbsp;r,g,b values
    for any pixel=pixels[ipixel]  whose value is 0,
    the second three for any pixel whose value is 1, etc.
    Obviously, pixel values must always be
    between&nbsp;0&nbsp;and&nbsp;#colors-1. </p>

<p> &nbsp;bgindex, if you haven't guessed, is the
    colortable[]&nbsp;index for the
    background&nbsp;color,&nbsp;i.e.,&nbsp;the pixel&nbsp;value
    for background pixels. Typically, bgindex=0, and the first
    three numbers in colortable[] are the&nbsp;r,g,b&nbsp;values for
    the background&nbsp;color&nbsp;(typically&nbsp;white=255,255,255). </p>

<p> The number of colors in colortable[] must be a
    power&nbsp;of&nbsp;2,&nbsp;e.g.,&nbsp;you must
    have&nbsp;6&nbsp;integers&nbsp;(for&nbsp;2&nbsp;colors),
    or&nbsp;12&nbsp;(for&nbsp;4), or&nbsp;etc,&nbsp;numbers
    in&nbsp;colortable[] preceding&nbsp;the&nbsp;&#150;1.
    A maximum of&nbsp;256&nbsp;r,g,b&nbsp;colors are permitted.</p>

<p class="pre"> The simplest usage is</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     int colortable[] = {255,255,255, 0,0,0, -1};</pre>
<p class="pre">&nbsp;for a monochrome black-on-white color&nbsp;table
    where corresponding pixel values
    may&nbsp;be&nbsp;0=white and 1=black.<br>
    For monochrome blue-on-white, simply write instead,</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     int colortable[] = {255,255,255, 0,0,255, -1};</pre>

<!--
<p> Note: The NULL argument at the end of putgif() in the
    <a href="#sampleprogram">sample&nbsp;program</a>
    is a placeholder for a "local&nbsp;colortable"
    that's discussed under <a href="#extensions">Extensions</a> below.
    You can ignore it unless rendering multiple-frame animations
    (and you can probably ignore it even then). </p>
-->

<h4 id="pixels">unsigned char pixels[ncols*nrows];</h4>
<p> &nbsp;unsigned char pixels[ncols*nrows]; which you must
    declare/malloc()/whatever yourself,
    is a sequence of bytes describing the pixels comprising
    your image.<br>
    pixels[]&nbsp;is always in row&nbsp;order, i.e.,<br>
      &nbsp; &nbsp; pixels[0]&nbsp;corresponds to
          the upper-left corner pixel,<br>
      &nbsp; &nbsp; pixels[ncols]&nbsp;to the leftmost pixel of
          the&nbsp;second&nbsp;row,<br>
      &nbsp; &nbsp; ...,<br>
      &nbsp; &nbsp; pixels[ncols*nrows-1] to the
          lower-right corner pixel.<br>
    Each pixels[]&nbsp;byte contains the color&nbsp;table&nbsp;index
    for the color to be displayed for that pixel.<br>
    For example, if<br>
      &nbsp; &nbsp; colortable[] =
          {255,255,255, 255,0,0, 0,255,0, 0,0,255, -1}<br>
    and<br>
      &nbsp; &nbsp; pixels[0] = 2<br>
    then your upper-left corner pixel will be green. </p>

<h3 id="sampleremarks"> additional sample program remarks </h3>
<p class="pre"> As you can see, the "template" for basic gifsave89 usage
    is pretty trivial...</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     generate_your_own(pixels,ncols,nrows);
     gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
     if ( gsdata != NULL ) {
       putgif(gsdata,pixels);
       nbytes = endgif(gsdata); }
     if ( nbytes &gt; 0 ) {
       do_what_you_want_with(gifimage,nbytes);
       free(gifimage); }</pre>
<p class="pre">&nbsp;along with the several required
    variable&nbsp;declarations illustrated in the
    <a href="#quickstart">quickstart</a> and
    <a href="#sampleprogram">sample&nbsp;program</a>
    sections above. </p>

<p> The hard part for any non-trivial image is typically
    generate_your_own(pixels,ncols,nrows).
    But that, of course, is entirely your problem.
    Once solved, gif&nbsp;rendering with&nbsp;gifsave89 is easy.</p>

<p> My motivation for writing gifsave89 was web&nbsp;pages
    with dynamic&nbsp;content, including on-the-fly&nbsp;images.
    With gifsave89, you can easily write a cgi&nbsp;program invoked
    by an &lt;img&gt; tag of the form<br>
    <nobr> &nbsp; &nbsp; &nbsp; &nbsp;
        &lt;img src="http://yourdomain.com/cgi-bin/yourprogram.cgi?query_string"&gt;</nobr><br>
    to generate gifs from users' query_string arguments,
    and then emit them to stdout preceded by appropriate http headers.
    You'd usually think of the src&nbsp;attribute as a static&nbsp;filename,
    but web&nbsp;servers will actually execute your cgi&nbsp;and
    interpret its stdout&nbsp;output (with http headers) as the image
    to be displayed. </p>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ EXTENSIONS
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="extensions"> (2) GIF89a Extensions in gifsave89 &nbsp; </h2>

<p class="pre">
    The <a href="http://www.w3.org/Graphics/GIF/spec-gif89a.txt">
    GIF89a&nbsp;Specification</a> provides four "extensions"
    not supported by the original GIF87a&nbsp;standard: </p>
    <ol style="margin-top:0;margin-bottom:0;margin-left:2em;">
      <li> <a href="#graphiccontrol">Graphic Control Extension</a> </li>
      <li> <a href="#animations">Application Extension</a> </li>
      <li> <a href="#plaintext">Plain Text Extension</a> </li>
      <li> Comment Extension </li>
    </ol>
<p class="pre">&nbsp;gifsave89 implements the first two as prescribed
    by the Specification, primarily to permit simple rendering
    of multiple-frame gif&nbsp;animations. <br>
         &nbsp; &nbsp; &nbsp; gifsave89a also contains a
    <a href="#plaintext">plaintxtgif()&nbsp;function</a> for
    the third extension's functionality, but implemented in
    a non-standard fashion. <br>
         &nbsp; &nbsp; &nbsp; Finally, the Comment&nbsp;extension
    is trivial, but serves no particular purpose for gifsave89 renderings,
    and isn't implemented. </p>

<h3 id="animations"> gif animations (application extension) </h3>
<p class="pre"> First make sure you've read and understood
    the "template" for basic gifsave89 usage illustrated in the
    <a href="#sampleremarks">remarks</a> above,
    and reproduced again below...</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
     if ( gsdata != NULL ) {
       generate_your_own(pixels,ncols,nrows);
       putgif(gsdata,pixels);
       nbytes = endgif(gsdata); }
     if ( nbytes &gt; 0 ) {
       do_what_you_want_with(gifimage,nbytes);
       free(gifimage); }</pre>

<br><p class="pre" id="animationtemplate">
    Did you notice <!-- the --> one minor change?&nbsp;<b>:</b>
    I&nbsp;moved "generate_your_own()&nbsp;pixels" inside
    the if(gsdata!=NULL){&nbsp;...&nbsp;} block.
    Suppose you have <b>nframes</b>&nbsp;frames to be displayed
    as a looped animation. The simple "template" change is...</p>
    <pre class="medium" style="margin-top:0;margin-bottom:0;">
    gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
    if ( gsdata != NULL ) {
      <b>animategif(gsdata,0,0,-1,2);</b>
      for ( iframe=0; iframe&lt;nframes; iframe++ ) {
        generate_your_own(<b>iframe,</b>pixels,ncols,nrows);
        putgif(gsdata,pixels); }
      nbytes = endgif(gsdata); }
    if ( nbytes &gt; 0 ) {
      do_what_you_want_with(gifimage,nbytes);
      free(gifimage); }</pre>

<p class="pre">&nbsp;generate_your_own() and putgif() are now in a
    loop&nbsp;over&nbsp;nframes which generates the animation
    frame-by-grame. &nbsp; generate_your_own() takes an extra
    iframe argument, from which it needs to generate pixels[]
    for that particular frame (you may or may not want to free(pixels)
    after calling putgif(), depending upon how generate_your_own()
    is coded). The putgif() call remains completely unchanged,
    simply adding each new frame to the gif. </p>

<br><p class="pre" id="animateprototype"> Just before the loop,
    animategif(gsdata,0,0,-1,2) emits what's called
    a "NETSCAPE2.0"&nbsp;application&nbsp;extension,
    which introduces gif animation sequences. The
    full function prototype&nbsp;is<br>
    <nobr>&nbsp; &nbsp; &nbsp;
      int animategif ( void *gsdata, int nrepetitions, int delay,
          int tcolor, int disposal ) </nobr><br>
    and the arguments
    following <a href="#newgifprototype">gsdata</a> are:</p>
  <ul style="margin-top:0;margin-bottom:0;margin-right:15em;">
    <li> 2nd arg nrepetitions: the number&nbsp;of&nbsp;repetitions
         before stopping, with&nbsp;<b>0</b>&nbsp;meaning loop
         the animation continuously. </li>
    <li> 3rd arg delay: the delay between frames in hundredths
         of a second, with&nbsp;<b>0</b>&nbsp;meaning no&nbsp;delay. </li>
    <li> 4th arg tcolor: the transparency&nbsp;color&nbsp;index
         (i.e.,&nbsp;the colortable[]&nbsp;index for a color,
         usually the background color, to be treated as transparent),
         with&nbsp;<b>-1</b>&nbsp;meaning no transparent color. </li>
    <li> 5th arg disposal: the disposal&nbsp;method, specifying the frame
         disposition after display, with&nbsp;<b>2</b>&nbsp;meaning
         "overwrite with background color".</li>
  </ul>
<p class="pre">&nbsp;See immediately below for further discussion
    of&nbsp;4th and&nbsp;5th&nbsp;args. </p>

<br><p class="pre"> There are two principal ways gif&nbsp;frames
    for animation are generated: </p>
  <ul style="margin-top:0;margin-bottom:0;margin-right:15em;">
    <li> Each frame is complete in itself, and the preceding
         frame should be discarded before displaying the
         next frame. </li>
    <li> The sequence of frames builds up in composite
         fashion, and each new frame should be superimposed
         on the total result built up from all preceding frames. </li>
  </ul>
<p class="pre">&nbsp;The above gifsave89 "template" defaults to
    the first method. For the second, change the illustrated
    animategif()&nbsp;call to&nbsp;animategif(gsdata,0,0,<b>0</b>,<b>1</b>),
    where the background color (presumably
    colortable[]&nbsp;index&nbsp;<b>0</b>) is now transparent, and where
    disposal&nbsp;method&nbsp;<b>1</b> means "do not dispose of graphic".
    See <a href="#graphiccontrol">graphic&nbsp;control</a>
    immediately below for further discussion of all these values. </p>

<h3 id="graphiccontrol"> graphic control extension </h3>
<p class="pre"> Besides the preceding
    <a href="#animations">animation&nbsp;modifications</a>,
    our "template" for basic gifsave89 usage from the
    <a href="#sampleremarks">remarks</a> above, and
    illustrated (yet&nbsp;again)&nbsp;below...</p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     gsdata = newgif(&gifimage,ncols,nrows,colortable,bgindex);
     if ( gsdata != NULL ) {
       generate_your_own(pixels,ncols,nrows);
       putgif(gsdata,pixels);
       nbytes = endgif(gsdata); }
     if ( nbytes &gt; 0 ) {
       do_what_you_want_with(gifimage,nbytes);
       free(gifimage); }</pre>
<p class="pre">&nbsp;may optionally be changed to include a controlgif()
    call immediately preceding putgif(), </p>
     <pre class="medium" style="margin-top:0;margin-bottom:0;">
     ...
     if ( gsdata != NULL ) {
       generate_your_own(pixels,ncols,nrows);
       <b>controlgif(gsdata,tcolor,delay,userinput,disposal);</b>
       putgif(gsdata,pixels);
       nbytes = endgif(gsdata); }
     ...</pre>
<p class="pre">&nbsp; which emits what's called
    a&nbsp;gif&nbsp;"Graphic&nbsp;Control&nbsp;Extension"&nbsp;block
    that modifies display of the subsequent putgif() image.
    Only one (or none) gifcontrol() is permitted preceding putgif().
    For multi-frame gifs, it's one (or none) preceding each putgif(). </p>

<br><p class="pre" id="controlprototype">
    The function prototype arguments<br>
    <nobr>&nbsp; &nbsp; &nbsp;
      int controlgif ( void *gsdata, int tcolor, int delay,
          int userinput, int disposal ) </nobr><br>
    following <a href="#newgifprototype">gsdata</a> are:</p>
  <ul style="margin-top:0;margin-bottom:0;margin-right:15em;">
    <li> 2nd arg tcolor: the transparency&nbsp;color&nbsp;index
         (i.e.,&nbsp;the colortable[]&nbsp;index for a color,
         usually the background color, to be treated as transparent),
         with&nbsp;<b>-1</b>&nbsp;meaning no transparent color. </li>
    <li> 3rd arg delay: the for multi-frame gifs, the delay between
         frames in hundredths of a second,
         with&nbsp;<b>0</b>&nbsp;meaning no&nbsp;delay. </li>
    <li> 4th arg userinput: for multi-frame gifs,&nbsp;<b>1</b>&nbsp;if 
         user&nbsp;input (mouseclick or keystroke) is required before
         the next frame is displayed (i.e., frames are displayed
         in slide-show&nbsp;fashion), or&nbsp;<b>0</b>&nbsp;if not. </li>
    <li> 5th arg disposal: the disposal&nbsp;method, specifying the frame
         disposition after display.
         Allowed values are <b>0,1,2,3</b>, with<br>
         <nobr> &nbsp; &nbsp; <b>0</b>:&nbsp;meaning "disposal method
               not specified",</nobr><br>
         <nobr> &nbsp; &nbsp; <b>1</b>:&nbsp;"do not dispose
               of graphic",</nobr><br>
         <nobr> &nbsp; &nbsp; <b>2</b>:&nbsp;"overwrite with
               background color",</nobr><br>
         <nobr> &nbsp; &nbsp; <b>3</b>:&nbsp;"restore preceding
               graphic".</nobr><br>
         </li>
  </ul>

<br><p class="pre"> For <a href="#animations">animations</a>, gifsave89
    saves you this trouble by automatically emitting a gifcontrol(),
    preceding each putgif(), all containing your animategif() values and
    the value userinput=0. To override these defaults, you can issue
    your own controlgif() preceding any (or every) putgif(),
    in which case gifsave89 doesn't emit its own.<br>
       &nbsp; &nbsp; &nbsp; For example, to pause an animation midway,
    wait for user&nbsp;input, and then continue, do the obvious </p>
    <pre class="medium" style="margin-top:0;margin-bottom:0;">
    ...
    if ( gsdata != NULL ) {
      animategif(gsdata,0,0,-1,2);
      for ( iframe=0; iframe&lt;nframes; iframe++ ) {
        generate_your_own(iframe,pixels,ncols,nrows);
        <b>if ( iframe == ipause )
          controlgif(gsdata,-1,0,1,2);</b>
        putgif(gsdata,pixels); }
      nbytes = endgif(gsdata); }
      ...</pre>
<p class="pre">&nbsp;Notice that the order of arguments
    ...,tcolor,delay,... is reversed between animategif() and controlgif().
    Sorry about that (I have my reasons:).</p>

<p> For <a href="#sampleremarks">single-frame&nbsp;gifs</a>,
    there's typically no need for controlgif(),
    unless you want to specify a transparent color index
    (most likely tcolor=bgindex, the background color index,
    as mentioned above). </p>

<h3 id="plaintext"> plain text extension </h3>

<p> &nbsp;gifsave89 contains a non-standard implementation of the intended
  <a href="http://www.libpng.org/pub/png/book/chapter11.html#png.ch11.div.14">
    gIFt&nbsp;PLAINTEXT</a>&nbsp;extension, which was deprecated almost
    immediately after being introduced, and which no other
    gif&nbsp;encoder/decoder (that I&nbsp;could find) now supports. </p>

<p> To use gifsave89's plaintext extension, your computer must have
    <a href="http://www.gnu.org/software/wget">wget</a>
    installed, and on your default path. If installed but not explicitly
    on your path, compile gifsave89 with the additional <br>
        &nbsp; &nbsp; &nbsp; <nobr><b>
        &#150;DWGET=\"/path/to/etc/wget\"</b></nobr><br>
    <b>&#150;switch</b>, ending with the
    filename&nbsp;(typically&nbsp;just&nbsp;wget)
    of the executable&nbsp;wget&nbsp;image. If&nbsp;wget isn't available
    on your computer, gifsave89 will still compile without complaint,
    but do not use the&nbsp;plaintxtgif()&nbsp;function described below. </p>

<p class="pre" id="plaintextprototype">
    The function prototype arguments<br>
    <nobr>&nbsp; &nbsp; &nbsp;
      int plaintxtgif ( void *gsdata, int left, int top,
          int width, int height, int fg, int bg, char *text ) </nobr><br>
    following <a href="#newgifprototype">gsdata</a> are:</p>
  <ul style="margin-top:0;margin-bottom:0;margin-right:15em;">
    <li> 2nd arg left: the "column&nbsp;index" of your gif&nbsp;image
         where the leftmost character of your text should be placed,
         i.e.,&nbsp;<b>0</b>&nbsp;for&nbsp;left-justified.
         Any negative number will horizontally center your text
         within the image. If your text is so wide that it goes
         beyond your image's right edge, then <b>left</b>&nbsp;is
         reduced so it fits. If wider then the entire image,
         the rightmost characters of your text are truncated. </li>
    <li> 3rd arg top: the "row&nbsp;index" of your gif&nbsp;image
         where the topmost pixel of the tallest character of your
         text should be placed, i.e.,&nbsp;<b>0</b>&nbsp;to
         place your text at the top of the image.
         Any negative number will vertically center your text
         within the image. If your text is so tall that it goes
         beyond your image's bottom edge, then <b>top</b>&nbsp;is
         reduced so it fits. If taller then the entire image,
         the bottoms of all your characters are truncated. </li>
    <li> 4th arg width: ... </li>
    <li> 5th arg height: width and height aren't used by gifsave89
         for their original purpose. Instead, if either or both
         is any negative number, then your text is "persistent",
         i.e.,&nbsp;placed on every (animation)&nbsp;frame that follows,
         until <a href="#endgifprototype">endgif()</a>&nbsp;is called,
         or until you issue another plaintxtgif()&nbsp;call.
         </li>
    <li> 6th arg fg: <a href="#colortable">colortable[]</a>
         index for text foreground </li>
    <li> 7th arg bg: colortable[] index for background </li>
    <li> 8th arg text: null-terminated string containing a valid
         <a href="http://www.forkosh.com/mathtextutorial.html">
         LaTeX&nbsp;math</a>&nbsp;expression.
         Note: passing text as a NULL pointer (or a zero-length string)
         signals plaintxtgif() to reset&nbsp;(turn&nbsp;off) plaintext,
         i.e.,&nbsp;any "persistent"&nbsp;text in effect will disappear.
         </li>
  </ul>

<br><p class="pre">
    After you call&nbsp;plaintxtgif(), gifsave89 simply "acquires"
    a pixelized&nbsp;(monochrome&nbsp;bytemap)&nbsp;rendering
    of your text, and overlays it (in the obvious way) on subsequent
    pixel&nbsp;image(s) that you supply to putgif().
    The trick is pixelizing your text. That's beyond gifsave89's
    functionality, and it instead issues a request to the
    <a href="http://www.forkosh.com/mimetex.html">
    mimeTeX&nbsp;</a>public&nbsp;web&nbsp;service&nbsp;(one of my other
    <a href="http://www.forkosh.com">open&nbsp;source&nbsp;projects</a>)
    via a popen("wget...","r")&nbsp;call. </p>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ COMPILING AND TESTING
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="compiling"> (3) Compiling and Testing gifsave89 &nbsp; </h2>
    <table border="0" cellpadding="0" cellspacing="0">
      <tr><td colspan=2>
          Very quickly &nbsp; -- &nbsp; download
          <a href="http://www.forkosh.com/gifsave89.zip">gifsave89.zip</a>
          and type </td></tr>
      <tr><td> &nbsp; &nbsp; &nbsp; &nbsp; </td>
          <td><b>unzip gifsave89.zip</b>
          </td></tr>
      <tr><td colspan=2> For testing, </td></tr>
      <tr><td> &nbsp; &nbsp; &nbsp; &nbsp; </td>
          <td>
            <b>cc &#150;DGSTESTDRIVE gifsave89.c
               &#150;lm &#150;o gifsave89</b> <br>
            To see example 1 (using ImageMagick's display):<br>
            &nbsp; &nbsp; <b>./gifsave89 1</b><br>
            &nbsp; &nbsp; <b>display gifsave89test.gif</b><br>
            To see example 2:<br>
            &nbsp; &nbsp; <b>./gifsave89 2</b><br>
            &nbsp; &nbsp; <b>display gifsave89test.gif</b>
          </td></tr>
      <tr><td colspan=2> For use with your own program, </td></tr>
      <tr><td> &nbsp; &nbsp; &nbsp; &nbsp; </td>
          <td>
            <b>cc yourprogram.c gifsave89.c &#150;o yourprogram</b> <br>
            (along with any other &#150;switches, etc, yourprogram requires)
          </td></tr>
      <tr><td colspan=2>
        Read the rest of this section only if you want
        more information.<hr size="2"></td></tr>
    </table>

<p class="continue"> gifsave89's source code is ansi standard C,
    which should compile and run without change on any platform.
    The steps needed to compile and test gifsave89 are: </p>

  <h3 style="margin-bottom:0;">
  Download gifsave89<font size=5>...</font> </h3>
  <ul style="margin-top:0">
   <li> Download and unzip 
        <a href="http://www.forkosh.com/gifsave89.zip">
        gifsave89.zip</a> in any convenient working directory.
        Your working directory should now contain
        <center> <table cellpadding=0 cellspacing=0>
         <tr><td width=150>README</td> <td>gifsave89 release notes</td></tr>
          <tr><td>COPYING</td>        <td>GPL license, version 3, under which
                                       you may use gifsave89</td></tr>
          <tr><td>gifsave89.c</td>    <td>gifsave89 source program and all
                                       required functions</td></tr>
          <tr><td>gifsave89.html</td> <td>this file, the gifsave89 user
                                       page</td></tr>
          <tr><td><a href="#gifgraph">gifgraph.c</a></td>
                                      <td>sample application discussed below
                                      (click link at left)
                                      </td></tr>
        </table> </center> </li>
  </ul>

  <h3 id="testdriver" style="margin-bottom:0;">
  Test gifsave89<font size=5>...</font> </h3>
  <ul style="margin-top:0">
   <li> To compile a gifsave89 executable with its own embedded
        test driver main() program, just type <br>
        <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
              cc &nbsp; &#150;DGSTESTDRIVE gifsave89.c &nbsp;
              &#150;lm &nbsp; &#150;o &nbsp; gifsave89test</b></nobr> </li>
   <li> Immediately after compiling this gifsave89 executable image,
        test it by typing <br>
        <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
              ./gifsave89 &nbsp; 1</b></nobr> <br>
        at the command prompt, whose screen output should look
        something like
    <pre class="medium" style="margin-top:0;margin-bottom:0;">
    +-----------------------------------------------------------------------+
    |gifsave89 ver1.00, Copyright(c) 2012-2012, John Forkosh Associates, Inc|
    |               (  current revision:  19 Sep 2012  )                    |
    +-----------------------------------------------------------------------+
    |gifsave89 is free software, licensed to you under terms of the GNU/GPL,|
    |           and comes with absolutely no warranty whatsoever.           |
    |     See http://www.forkosh.com/gifsave89.html for further details.    |
    +-----------------------------------------------------------------------+
    GIF image written to file: gifsave89test.gif</pre>
        Now bring up the output&nbsp;file <b>gifsave89test.gif</b>
        in any gif viewer, like ImageMagick's&nbsp;display,
        or in your browser. You should see a gif identical to
        the one displayed in the top-left corner of this page. </li>
   <li> Now repeat the test, this time typing <br>
        <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
              ./gifsave89 &nbsp; 2</b></nobr> <br>
        and you should see a gif identical to
        the one displayed in the top-right corner of this page. </li>
  </ul>

  <h3 id="compileyourprogram" style="margin-bottom:0;">
  Use gifsave89<font size=5>...</font> </h3>
  <ul style="margin-top:0;margin-right:10em;">
   <li> To compile your own program using gifsave89, just type <br>
        <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
              cc &nbsp; yourprogram.c &nbsp; gifsave89.c
              &nbsp; &#150;o &nbsp; yourprogram</b></nobr><br>
        along with any other <b>&#150;<i>switches</i></b>, etc,
        that yourprogram requires. <br> </li>
   <li> The sample application discussed below,
        <a href="#gifgraph">gifgraph.c</a>, in your
        <a href="http://www.forkosh.com/gifsave89.zip">gifsave89.zip</a>
        distribution is a cgi&nbsp;program that can be compiled
        by typing<br>
        <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
              cc &nbsp; gifgraph.c &nbsp; gifsave89.c
              &nbsp; &#150;o &nbsp; gifgraph.cgi</b></nobr><br>
        in exactly the preceding fashion. </li>
  </ul>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ GIFGRAPH
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="gifgraph"> (4) gifgraph.c, an expression graphing cgi &nbsp; </h2>
<p> Your <a href="http://www.forkosh.com/gifsave89.zip">gifsave89.zip</a>
    distribution contains a more complete, and much more useful, program than
    either the <a href="#sampleprogram">sample&nbsp;program</a> above or
    gifsave89's&nbsp;<a href="#testdriver">main()&nbsp;test&nbsp;driver</a>,
    that you can easily compile following
    the&nbsp;<a href="#compileyourprogram">instructions&nbsp;above</a>,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       cc &nbsp; gifgraph.c &nbsp; gifsave89.c
       &nbsp; &#150;o &nbsp; gifgraph.cgi</b></nobr><br>
    It presently runs only on Unix-like systems where the
    <a href="http://www.gnu.org/software/bc/manual/html_mono/bc.html">
    bc</a>&nbsp;"calculator" is installed (on your default path).</p>

<p> After compiling gifgraph.cgi,&nbsp;<b>mv</b>&nbsp;it to
    your&nbsp;<b>cgi-bin/</b>&nbsp;directory, <b>chmod</b>&nbsp;permissions
    as necessary, and now try typing into your browser's locator window
    (if you see an "Internal&nbsp;Server&nbsp;Error&nbsp;500",
    try typing more carefully&nbsp;<b>--</b>&nbsp;that bc&nbsp;calculator
    can be finicky<b>:</b>),<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       http://www.yourdomain.com/cgi-bin/gifgraph.cgi?
       200&100&s(x+t)+.5*s(2.*x+3.*t)</b></nobr></br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       &x=0.0;x<6.283;x+=0.05&t=0.0;t<6.283;t+=0.05</b></nobr><br>
    and you should see, <br>
    <nobr> &nbsp; &nbsp; &nbsp; &nbsp;
      <img src="http://www.forkosh.com/images/gifsave89/example4.gif"
      width=200 height=100></nobr><br>
    A static image at, say, <b>t=0</b> is displayed if you omit
    the last query&nbsp;string&nbsp;argument and adjust the expression
    accordingly,&nbsp;i.e.,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       http://www.yourdomain.com/cgi-bin/gifgraph.cgi?
       200&100&s(x)+.5*s(2.*x)$</b></nobr></br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       &x=0.0;x<6.283;x+=0.05</b></nobr><br>
    displays, <br>
    <nobr> &nbsp; &nbsp; &nbsp; &nbsp;
      <img src="http://www.forkosh.com/images/gifsave89/example5.gif"
      width=200 height=100></nobr><br>
    The extra <b>$</b> at the end of the "static"&nbsp;bc&nbsp;expression
    suppresses gifgraph's default title generation,
    displayed with the animation and explained below. </p>

<p> Before proceeding to explain what's happening,
    note that you can see the same images above on any html&nbsp;page
    by placing identical &lt;img&gt; tags
    wherever you want them displayed,&nbsp;i.e.,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       &lt;img src="http://www.yourdomain.com/cgi-bin/gifgraph.cgi?</b></nobr><br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       200&100&s(x+t)+.5*s(2.*x+3.*t)&</b></nobr></br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       x=0.0;x<6.283;x+=0.05&t=0.0;t<6.283;t+=0.05"&gt;</b></nobr><br>
    for the animation, or,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       &lt;img src="http://www.yourdomain.com/cgi-bin/gifgraph.cgi?</b></nobr><br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       200&100&s(x)+.5*s(2.*x)$&x=0.0;x<6.283;x+=0.05"&gt;</b></nobr><br>
    for the static&nbsp;<b>t=0</b> image. So this small gifgraph utility
    lets your web&nbsp;pages easily display on-the-fly function graphs of any
    bc&nbsp;expression submitted, either by hard-coded &lt;img&gt;&nbsp;tags
    as illustrated above, or as generated by php&nbsp;scripts from parameters
    users enter on a&nbsp;&lt;form&gt;,&nbsp;or&nbsp;etc,&nbsp;etc. </p>

<p class="pre" id="gifgraphprototype">
    To use gifgraph effectively, you first need sufficient knowledge of the
    <a href="http://www.gnu.org/software/bc/manual/html_mono/bc.html">
    unix/gnu&nbsp;bc</a>&nbsp;calculator language to express functions
    you want graphed. Then the situation is pretty straightforward<b>:</b>
    &nbsp; gifgraph's query&nbsp;string comprises five
    arguments (the fifth one, for animations, optional),<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       width &amp; height &amp; expression &amp; x-range &amp; t-range
       </b></nobr><br> </p>
  <ul style="margin-top:0;margin-bottom:0;margin-left:5em;margin-right:5em;">
    <li> <b>width</b> &nbsp; width of the graphic in pixels</li>
    <li> <b>height</b> &nbsp; height of the graphic in pixels</li>
    <li> <b>expression</b> &nbsp; bc statement(s) defining the function
         to be graphed, in terms of variables defined in <b>x-range</b>
         (and optionally in <b>t-range</b>). Your <b>expression</b>
         may also contain an optional trailing <b>expression$title</b>,
         explained below. </li>
    <li> <b>x-range</b> bc statements of the form <b>x=0;x&lt;100;x++</b>
         which gifgraph places inside a <b>for(&nbsp;)</b>.</li>
    <li> <b>t-range</b> bc statements of the form <b>t=0;t&lt;100;t++</b>
         which gifgraph places inside a <b>for(&nbsp;)</b> preceding
         your <b>for(x-range)</b>.</li>
  </ul>
<p class="pre">&nbsp;That is, the entire bc&nbsp;"program" gifgraph
    constructs looks something like,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       for ( t-range ) { for ( x-range ) { expression } }</b></nobr><br>
    with the <b>t-range</b>&nbsp;loop omitted if you don't supply
    that argument. The variable&nbsp;names used in your <b>expression</b>
    must be defined in <b>x-range</b> and <b>t-range</b>, but are otherwise
    your choice. And <b>expression</b> must print exactly one number
    per line, presumably one number each time it's executed (but you
    can get tricky about that if you like).<br>
        &nbsp; &nbsp; &nbsp; I&nbsp;illustrated variable names
    <b>x</b>&nbsp;and&nbsp;<b>t</b> for the (hopefully)
    obvious&nbsp;reason<b>:</b> Each pass through the
    <b>x-range</b>&nbsp;loop results in a sequence of numbers
    that comprise one frame of the gif&nbsp;animation gifgraph renders,
    or that comprise the entire static&nbsp;gif&nbsp;image
    if <b>t-range</b>&nbsp;is&nbsp;omitted.
    If not omitted, the next frame is rendered from the sequence
    of numbers printed for the next&nbsp;<b>t</b>-value,&nbsp;etc.
    That&nbsp;is,&nbsp;if&nbsp;<b>expression</b>
    defines a function&nbsp;<b>f(x,t)</b>, then the sequence of
    values&nbsp;<b>f(x_0,t_0),f(x_1,t_0),...,f(x_n,t_0)</b> comprise
    the first frame,&nbsp;<b>f(x_0,t_1),f(x_1,t_1),...,f(x_n,t_1)</b>
    comprise the second frame, and so on. Thus, an&nbsp;<b>expression</b>
    like&nbsp;<b>s(x+t)</b>&nbsp;(recall that&nbsp;s(&nbsp;)
    means&nbsp;sin(&nbsp;) for&nbsp;bc) renders a simple moving sine wave
    (assuming that <b>x-range</b>&nbsp;is&nbsp;<b>x=0;x&lt;6.28;x+=.05;</b>,
    or the like, and similarly for&nbsp;<b>t-range</b>).</p>

<p> &nbsp;gifgraph uses gifsave89's
    <a href="#plaintext">plaintext</a>&nbsp;extension
    to horizontally&nbsp;center a default title consisting
    of your <a href="#gifgraphprototype">expression</a>
    at the bottom of your graph,
    unless instructed otherwise, as follows. <br>
        &nbsp; &nbsp; &nbsp; A&nbsp;<b>$</b>&nbsp;character
    anywhere in your <b>expression</b> terminates it,
    and only characters preceding&nbsp;<b>$</b> are submitted
    to the bc&nbsp;calculator.
    Characters following&nbsp;<b>$</b> comprise the displayed
    title. If no characters (or only whitespace) follow&nbsp;<b>$</b>,
    then no title is displayed at all. Otherwise, those characters
    are rendered by gifsave89's&nbsp;plaintext&nbsp;extension.<br>
    For example,<br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       &lt;img src="http://www.yourdomain.com/cgi-bin/gifgraph.cgi?</b></nobr><br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       255&255 & x*s((x/4.+t)/6.2832)
       $ x*\left.\sin\left(\frac{x/4+t}{2\pi}\right)</b></nobr><br>
    <nobr><b> &nbsp; &nbsp; &nbsp; &nbsp;
       \right|_{x=0,t=0}^{x=200,t=100}
       & x=0.0;x<200.;x+=1. & t=0.0;t<100.;t+=1." &gt;</b></nobr><br>
    renders, <br>
    <nobr> &nbsp; &nbsp; &nbsp; &nbsp;
      <img src="http://www.forkosh.com/images/gifsave89/example6.gif"
      ></nobr><br>
    </p>

<p> The gifgraph.c main()&nbsp;program is relatively simple and
    straightforward, reflecting its illustrative purpose.
    While you could use it straight&nbsp;out-of-the-box for
    production purposes, it should probably be enhanced to cache
    rendered images for use in high-traffic situations. </p>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ GPL
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="gpl"> (5) GPL License &nbsp; </h2>

<font color="black">
<b>&quot</b><i>My grandfather once told me there are two kinds of people:<br>
&nbsp &nbsp Those who do the work and those who take the credit.<br>
&nbsp &nbsp He told me to try to be in the first group; there was much
less competition.</i><b>&quot</b><br>
Indira Gandhi, the late Prime Minister of India</font> <br>

 <p class="continue"> 
     gifsave89's copyright is registered by me with the US Copyright Office,
     and I hereby license it to you under the terms and conditions of the
     <a href="http://www.gnu.org/licenses/gpl.html" target="_top">GPL</a>.
     There is no official support of any kind whatsoever,
     and you use gifsave89 entirely at your own risk, with no guarantee
     of any kind, in particular with no warranty of merchantability. </p>

 <p> By using gifsave89, you warrant that you have read, understood
     and agreed to these terms and conditions, and that you possess
     the legal right and ability to enter into this agreement
     and to use gifsave89 in accordance with it. </p>

 <p> Hopefully, the law and ethics regarding computer programs will
     evolve to make this kind of obnoxious banter unnecessary.
     In the meantime, please forgive me my paranoia. </p>

 <p> To protect your own intellectual property, I recommend (all are pdf)
     <a href="http://www.copyright.gov/circs/circ01.pdf"
     target="_top">Copyright&nbsp;Basics</a> from The Library of Congress,
     in particular <a href="http://www.copyright.gov/circs/circ61.pdf"
     target="_top">Circular&nbsp;61</a>, Copyright Registration for
     Computer Programs. Very briefly, download
     <a href="http://www.copyright.gov/forms/formtxi.pdf">Form&nbsp;TX</a>
     and follow the included instructions.
     In principle, you automatically own the copyright
     to anything you write the moment it's on paper.  In practice,
     if the matter comes under dispute, the courts look _very_ favorably
     on you for demonstrating your intent by registering the copyright
     beforehand. (For example, courts will stop unauthorized use of
     unregistered material, but monetary damages are typically awarded
     _only_ if you register the copyright before infringement occurs.) </p>


<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ CONCLUDING REMARKS
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2 id="remarks"> Concluding Remarks &nbsp; </h2>

<p> I hope you find gifsave89 useful.  If so, a contribution to
  the <a href="http://www.gnu.org" target="_top">GNU</a> project, is
  suggested, especially if you're a company that's currently profitable. </p>
  

<!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Footer across bottom of page
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<hr size=4>
<table> <tr>
 <td align="left" width="70%"> <font size=3 color="maroon"> <b>
  <nobr>Copyright <font size=5>&copy;</font> 2012-2012,
  <a href="http://www.forkosh.com">John Forkosh Associates, Inc.</a>
  </nobr><br>
  email: <a href="mailto:john&#64;forkosh&#46;com">john&#64;forkosh&#46;com</a>
  </b> </font> </td>
<!--
 <td> <img src="../cgi-bin/mimetex.cgi?\hspace{50}" alt="" border=0> </td>
 <td align="left" width="30%">
      <img src="../cgi-bin/mimetex.cgi?\blue{\small\rm You're the }
       \Large\counter[counters.log]
       {counters.txt:gifsave89.html}\\[0]
       {\small\rm visitor to this page.}" alt="" border=0 align=bottom> </td>
-->
</tr> </table>
</body>
</html>
<!-- end-of-file gifsave89.html -->

